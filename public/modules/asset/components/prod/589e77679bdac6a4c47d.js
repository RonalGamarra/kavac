(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{CHCY:function(t,e,s){"use strict";s.r(e);var a=new FormData,i={data:function(){return{record:{id:"",type:"",asset_request_id:"",description:"",equipments:[],document_id:""},types:[],equipments:[],records:[],errors:[],columns:["type","description","id"],columns_equipments:["check","asset.inventory_serial","asset.serial","asset.marca","asset.model"],selected:[],selectAll:!1,table_options:{rowClassCallback:function(t){var e=document.getElementById("checkbox_"+t.asset_id);return e&&e.checked?"selected-row cursor-pointer":"cursor-pointer"},headings:{type:"Tipo",description:"Descripción",id:"Acción","asset.inventory_serial":"Código","asset.serial":"Serial","asset.marca":"Marca","asset.model":"Modelo"},sortable:["type","asset.inventory_serial","asset.serial","asset.marca","asset.model"],filterable:["type","asset.inventory_serial","asset.serial","asset.marca","asset.model"]}}},props:{id:Number,state:String},methods:{toggleActive:function(t){var e=t.row,s=document.getElementById("checkbox_"+e.asset_id);if(s&&0==s.checked)(a=this.selected.indexOf(e.asset_id))>=0?this.selected.splice(a,1):s.click();else if(s&&1==s.checked){var a;(a=this.selected.indexOf(e.asset_id))>=0?s.click():this.selected.push(e.asset_id)}},select:function(){var t=this;t.selected=[],$.each(t.equipments,(function(e,s){var a=document.getElementById("checkbox_"+s.asset_id);t.selectAll?a&&a.checked&&a.click():t.selected.push(s.asset_id)}))},reset:function(){this.record={id:"",type:"",asset_request_id:"",description:"",equipments:[],document_id:""}},createRequest:function(t){var e=this;if(e.record.asset_request_id=e.id,e.record.equipments=e.selected,e.record.id)e.updateRecord(t);else{for(var s in e.loading=!0,this.record)"equipments"==s?a.append(s,JSON.stringify(e.record[s])):a.append(s,e.record[s]);axios.post("/"+t,a,{headers:{"Content-Type":"multipart/form-data"}}).then((function(s){void 0!==s.data.redirect?location.href=s.data.redirect:(e.errors=[],e.reset(),e.readRecords(t),e.loading=!1,e.showMessage("store"))})).catch((function(t){if(e.errors=[],void 0!==t.response)for(var s in t.response.data.errors)t.response.data.errors[s]&&e.errors.push(t.response.data.errors[s][0]);e.loading=!1}))}},getTypes:function(){var t=this;axios.get("/asset/get-request-types").then((function(e){t.types=e.data}))},getEquipments:function(){var t=this;axios.get("/asset/requests/get-equipments/"+this.id).then((function(e){t.equipments=e.data}))},viewMessage:function(){return this.showMessage("custom","Alerta","danger","screen-error","La solicitud está en un tramite que no le permite acceder a esta funcionalidad"),!1},processFile:function(){var t=this,e=document.querySelector("#file");a.append("file",e.files[0]),t.showMessage("custom","Éxito","success","screen-ok","Documento cargado de manera existosa.")}},created:function(){this.getTypes(),this.getEquipments(),this.record.equipments=[]}},r=s("KHd+"),n=Object(r.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("a",{staticClass:"btn btn-success btn-xs btn-icon btn-action",attrs:{href:"#",title:"Registros de Eventos","data-toggle":"tooltip",disabled:"Aprobado"!=t.state&&"Pendiente por entrega"!=t.state},on:{click:function(e){"Aprobado"==t.state||"Pendiente por entrega"==t.state?t.addRecord("add_event","requests/request-event",e):t.viewMessage()}}},[s("i",{staticClass:"fa fa-list-alt"})]),t._v(" "),s("div",{staticClass:"modal fade text-left",attrs:{tabindex:"-1",role:"dialog",id:"add_event"}},[s("div",{staticClass:"modal-dialog vue-crud",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),s("div",{staticClass:"modal-body"},[t.errors.length>0?s("div",{staticClass:"alert alert-danger"},[s("div",{staticClass:"container"},[t._m(1),t._v(" "),s("strong",[t._v("Cuidado!")]),t._v(" Debe verificar los siguientes errores antes de continuar:\n\t\t\t\t\t\t\t\t"),s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"alert","aria-label":"Close"},on:{click:function(e){e.preventDefault(),t.errors=[]}}},[t._m(2)]),t._v(" "),s("ul",t._l(t.errors,(function(e){return s("li",[t._v(t._s(e))])})),0)])]):t._e(),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-md-6"},[s("div",{staticClass:"form-group is-required"},[s("label",[t._v("Tipo de Evento:")]),t._v(" "),s("select2",{attrs:{options:t.types,"data-toggle":"tooltip",title:"Indique el tipo de evento ocurrido"},model:{value:t.record.type,callback:function(e){t.$set(t.record,"type",e)},expression:"record.type"}}),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.record.id,expression:"record.id"}],attrs:{type:"hidden"},domProps:{value:t.record.id},on:{input:function(e){e.target.composing||t.$set(t.record,"id",e.target.value)}}})],1)]),t._v(" "),s("div",{staticClass:"col-md-6"},[s("div",{staticClass:"form-group is-required"},[s("label",[t._v("Descripción del Evento")]),t._v(" "),s("ckeditor",{staticClass:"form-control",attrs:{editor:t.ckeditor.editor,id:"description_event","data-toggle":"tooltip",title:"Indique una descripción del evento",config:t.ckeditor.editorConfig,name:"description_event","tag-name":"textarea",rows:"3"},model:{value:t.record.description,callback:function(e){t.$set(t.record,"description",e)},expression:"record.description"}})],1)])]),t._v(" "),s("div",{staticClass:"row"},[s("div",{directives:[{name:"show",rawName:"v-show",value:2==t.record.type,expression:"record.type == 2"}],staticClass:"col-md-6"},[s("input",{attrs:{type:"hidden",id:"documents",name:"documents",readonly:""}}),t._v(" "),s("div",{staticClass:"form-group is-required"},[s("div",{staticClass:"feature-list-content p-0"},[s("div",{staticClass:"feature-list-content-wrapper"},[t._m(3),t._v(" "),s("div",{staticClass:"feature-list-content-right feature-list-content-actions"},[t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),s("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"file",name:"file",accept:".doc, .pdf, .odt, .docx"},on:{change:function(e){return t.processFile()}}})])])])])])]),t._v(" "),s("hr"),t._v(" "),s("div",{staticClass:"row"},[t._m(7),t._v(" "),s("div",{staticClass:"col-md-12"},[s("v-client-table",{ref:"tableevent",attrs:{columns:t.columns_equipments,data:t.equipments,options:t.table_options},on:{"row-click":t.toggleActive},scopedSlots:t._u([{key:"check",fn:function(e){return s("div",{staticClass:"text-center"},[s("label",{staticClass:"form-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"cursor-pointer",attrs:{type:"checkbox",id:"checkbox_"+e.row.asset_id},domProps:{value:e.row.asset_id,checked:Array.isArray(t.selected)?t._i(t.selected,e.row.asset_id)>-1:t.selected},on:{change:function(s){var a=t.selected,i=s.target,r=!!i.checked;if(Array.isArray(a)){var n=e.row.asset_id,o=t._i(a,n);i.checked?o<0&&(t.selected=a.concat([n])):o>-1&&(t.selected=a.slice(0,o).concat(a.slice(o+1)))}else t.selected=r}}})])])}}])},[s("div",{staticClass:"text-center",attrs:{slot:"h__check"},slot:"h__check"},[s("label",{staticClass:"form-checkbox"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.selectAll,expression:"selectAll"}],staticClass:"cursor-pointer",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.selectAll)?t._i(t.selectAll,null)>-1:t.selectAll},on:{click:function(e){return t.select()},change:function(e){var s=t.selectAll,a=e.target,i=!!a.checked;if(Array.isArray(s)){var r=t._i(s,null);a.checked?r<0&&(t.selectAll=s.concat([null])):r>-1&&(t.selectAll=s.slice(0,r).concat(s.slice(r+1)))}else t.selectAll=i}}})])])])],1)])]),t._v(" "),s("div",{staticClass:"modal-body modal-table"},[s("hr"),t._v(" "),s("v-client-table",{attrs:{columns:t.columns,data:t.records,options:t.table_options},scopedSlots:t._u([{key:"type",fn:function(e){return s("div",{staticClass:"text-center"},t._l(t.types,(function(a){return s("div",[e.row.type==a.id?s("span",[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(a.text)+"\n\t\t\t\t\t\t\t\t\t")]):t._e()])})),0)}},{key:"id",fn:function(e){return s("div",{staticClass:"text-center"},[s("button",{staticClass:"btn btn-warning btn-xs btn-icon btn-action",attrs:{title:"Modificar registro","data-toggle":"tooltip",type:"button"},on:{click:function(s){return t.initUpdate(e.index,s)}}},[s("i",{staticClass:"fa fa-edit"})]),t._v(" "),s("button",{staticClass:"btn btn-danger btn-xs btn-icon btn-action",attrs:{title:"Eliminar registro","data-toggle":"tooltip",type:"button"},on:{click:function(s){return t.deleteRecord(e.index,"requests/request-event")}}},[s("i",{staticClass:"fa fa-trash-o"})])])}}])})],1),t._v(" "),s("div",{staticClass:"modal-footer"},[s("button",{staticClass:"btn btn-default btn-sm btn-round btn-modal-close",attrs:{type:"button","data-dismiss":"modal"}},[t._v("\n\t                \t\tCerrar\n\t                \t")]),t._v(" "),s("button",{staticClass:"btn btn-primary btn-sm btn-round btn-modal-save",attrs:{type:"button"},on:{click:function(e){return t.createRequest("asset/requests/request-event")}}},[t._v("\n\t                \t\tGuardar\n\t\t                ")])])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])]),this._v(" "),e("h6",[e("i",{staticClass:"icofont icofont-tasks-alt ico-2x"}),this._v("\n\t\t\t\t\t\t\tNuevo Evento\n\t\t\t\t\t\t")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"alert-icon"},[e("i",{staticClass:"now-ui-icons objects_support-17"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{attrs:{"aria-hidden":"true"}},[e("i",{staticClass:"now-ui-icons ui-1_simple-remove"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"feature-list-content-left"},[e("div",{staticClass:"feature-list-heading"},[e("label",[this._v("Informe de Especificación:")]),this._v(" "),e("div",{staticClass:"badge badge-danger ml-2",attrs:{title:"El documento aún no ha sido cargado","data-toggle":"tooltip"}},[this._v("\n\t\t\t\t\t                                \tpor cargar\n\t\t\t\t\t                                ")])]),this._v(" "),e("div",{staticClass:"feature-list-subheading"},[e("i",[this._v("Operaciones")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-simple btn-success btn-events",attrs:{title:"Presione para cargar el documento","data-toggle":"tooltip",type:"button",onclick:"$('#file').click()"}},[e("i",{staticClass:"fa fa-cloud-upload fa-2x"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-simple btn-primary btn-events",attrs:{title:"Presione para descargar el documento","data-toggle":"tooltip",type:"button"}},[e("i",{staticClass:"fa fa-cloud-download fa-2x"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"btn btn-sm btn-danger btn-action",attrs:{type:"button",title:"Eliminar documento","data-toggle":"tooltip"}},[e("i",{staticClass:"fa fa-minus-circle"})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-12"},[e("b",[this._v("Seleccione los equipos afectados")])])}],!1,null,null,null);e.default=n.exports}}]);