(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"9T5y":function(t,e,r){"use strict";r.r(e);var i={props:{date:{type:String,default:""},fiscal_years:{type:Object,default:function(){return null}},institutions:{type:Array,default:function(){return[{id:"",text:"Seleccione..."}]}},purchase_supplier_types:{type:Array,default:function(){return[{id:"",text:"Seleccione..."}]}},measurement_units:{type:Array,default:function(){return[{id:"",text:"Seleccione..."}]}},requirement_edit:{type:Object,default:function(){return null}},department_list:{type:Array,default:function(){return[{id:"",text:"Seleccione..."}]}}},data:function(){return{record:{institution_id:"",contracting_department_id:"",user_department_id:"",warehouse_id:"",purchase_supplier_type_id:"",description:"",fiscal_year_id:"",products:[]},product:{},products:[],compare_contracting_department_id:"",departments:[],record_products:[],toDelete:[],columns:["name","measurement_unit","technical_specifications","quantity","id"]}},created:function(){this.table_options.headings={name:"Producto",measurement_unit:"Unidad de Medida",technical_specifications:"Especificaciones tecnicas",quantity:"Cantidad",id:"ACCIÓN"},this.table_options.columnsClasses={name:"col-xs-4",measurement_unit:"col-xs-1",technical_specifications:"col-xs-4",quantity:"col-xs-2",id:"col-xs-1"},this.requirement_edit&&(this.departments=this.department_list)},mounted:function(){this.record.fiscal_year_id=this.fiscal_years.id,this.requirement_edit&&(this.record.description=this.requirement_edit.description,this.record.institution_id=1,this.record.contracting_department_id=this.requirement_edit.contracting_department_id,this.record.user_department_id=this.requirement_edit.user_department_id,this.record.purchase_supplier_type_id=this.requirement_edit.purchase_supplier_type_id,this.record.fiscal_year_id=this.requirement_edit.fiscal_year_id,this.record_products=this.requirement_edit.purchase_requirement_items)},methods:{reset:function(){this.record={institution_id:"",contracting_department_id:"",user_department_id:"",warehouse_id:"",purchase_supplier_type_id:"",description:"",products:[]},this.$refs.PurchaseFormComponent.reset()},createRecord:function(){var t=this,e=this;e.record.products=e.record_products,e.loading=!0,e.requirement_edit?(e.record.toDelete=e.toDelete,axios.put("/purchase/requirements/"+e.requirement_edit.id,e.record).then(function(t){e.loading=!1,e.showMessage("update"),setTimeout(function(){location.href="/purchase/requirements"},2e3)}).catch(function(r){e.loading=!1,t.$refs.PurchaseFormComponent.reset();var i=[];if(void 0!==r.response)for(var s in r.response.data.errors)r.response.data.errors[s]&&i.push(r.response.data.errors[s][0]);t.$refs.PurchaseFormComponent.showAlertMessages(i)})):axios.post("/purchase/requirements",e.record).then(function(t){e.loading=!1,e.showMessage("store"),setTimeout(function(){location.href="/purchase/requirements"},2e3)}).catch(function(r){e.loading=!1,t.$refs.PurchaseFormComponent.reset();var i=[];if(void 0!==r.response)for(var s in r.response.data.errors)r.response.data.errors[s]&&i.push(r.response.data.errors[s][0]);t.$refs.PurchaseFormComponent.showAlertMessages(i)})},getDepartments:function(){var t=this;t.departments=[],""!=t.record.institution_id&&axios.get("/get-departments/"+t.record.institution_id).then(function(e){t.departments=e.data,t.getWarehouseProducts()})},removeProduct:function(t,e){var r=this.record_products.splice(t-1,1)[0];r.updated_at&&this.toDelete.push(r.id)},getWarehouseProducts:function(){var t=this;this.products=[],axios.get("/warehouse/get-warehouse-products/").then(function(e){t.products=e.data})},changeQty:function(t){t.type;var e=t.target;this.record_products[e.id-1].quantity=e.value},changeTecnicalSpecifications:function(t){t.type;var e=t.target;this.record_products[e.id-1].technical_specifications=e.value},changeMeasurementUnit:function(t,e){this.record_products[t-1].measurement_unit_id=e}},watch:{product:function(t){if(t)for(var e=0;e<this.products.length;e++)this.products[e].id==t&&this.record_products.push({id:t,name:this.products[e].text,quantity:0,technical_specifications:"",measurement_unit_id:""})}}},s=r("KHd+"),n=Object(s.a)(i,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"form-horizontal"},[r("div",{staticClass:"card-body"},[r("purchase-show-errors",{ref:"PurchaseFormComponent"}),t._v(" "),r("div",{staticClass:"row"},[t._m(0),t._v(" "),r("div",{staticClass:"col-3"},[r("div",{staticClass:"form-group"},[r("label",{staticClass:"control-label"},[t._v("Fecha de generación")]),r("br"),t._v(" "),r("label",{staticClass:"control-label"},[r("h5",[t._v(t._s(t.format_date(t.requirement_edit?t.requirement_edit.created_at:t.date)))])])])]),t._v(" "),r("div",{staticClass:"col-3"},[r("div",{staticClass:"form-group"},[r("label",{staticClass:"control-label"},[t._v("Ejercicio económico")]),r("br"),t._v(" "),r("label",{staticClass:"control-label"},[r("h5",[t._v(t._s(t.fiscal_years.year))])])])]),t._v(" "),r("div",{staticClass:"col-3"},[r("div",{staticClass:"form-group is-required"},[r("label",{staticClass:"control-label",attrs:{for:"institutions"}},[t._v("Institución")]),r("br"),t._v(" "),r("select2",{attrs:{options:t.institutions,id:"institutions"},on:{input:function(e){return t.getDepartments()}},model:{value:t.record.institution_id,callback:function(e){t.$set(t.record,"institution_id",e)},expression:"record.institution_id"}})],1)]),t._v(" "),r("div",{staticClass:"col-3"},[r("div",{staticClass:"form-group is-required"},[r("label",{staticClass:"control-label",attrs:{for:"departments1"}},[t._v("Unidad contratante")]),r("br"),t._v(" "),r("select2",{attrs:{options:t.requirement_edit?t.department_list:t.departments,id:"departments1"},model:{value:t.record.contracting_department_id,callback:function(e){t.$set(t.record,"contracting_department_id",e)},expression:"record.contracting_department_id"}})],1)]),t._v(" "),r("div",{staticClass:"col-3"},[r("div",{staticClass:"form-group is-required"},[r("label",{staticClass:"control-label",attrs:{for:"departments2"}},[t._v("Unidad usuario")]),r("br"),t._v(" "),r("select2",{attrs:{options:t.requirement_edit?t.department_list:t.departments,id:"departments2"},model:{value:t.record.user_department_id,callback:function(e){t.$set(t.record,"user_department_id",e)},expression:"record.user_department_id"}})],1)]),t._v(" "),r("div",{staticClass:"col-3"},[r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"purchase_supplier_types"}},[t._v("Tipo")]),t._v(" "),r("select2",{attrs:{options:t.purchase_supplier_types,id:"purchase_supplier_types"},model:{value:t.record.purchase_supplier_type_id,callback:function(e){t.$set(t.record,"purchase_supplier_type_id",e)},expression:"record.purchase_supplier_type_id"}})],1)]),t._v(" "),r("div",{staticClass:"col-6"},[r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"description"}},[t._v("Descripción")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.record.description,expression:"record.description"}],staticClass:"form-control",attrs:{type:"text",id:"description"},domProps:{value:t.record.description},on:{input:function(e){e.target.composing||t.$set(t.record,"description",e.target.value)}}})])])]),t._v(" "),r("hr"),t._v(" "),r("div",{staticClass:"row"},[t._m(1),t._v(" "),r("div",{staticClass:"col-6"},[r("div",{staticClass:"form-group is-required"},[r("label",[t._v("Nombre del Producto")]),t._v(" "),r("select2",{attrs:{options:t.products},model:{value:t.product,callback:function(e){t.product=e},expression:"product"}})],1)])]),t._v(" "),r("hr"),t._v(" "),r("v-client-table",{staticClass:"row",attrs:{columns:t.columns,data:t.record_products,options:t.table_options},scopedSlots:t._u([{key:"measurement_unit",fn:function(e){return r("div",{staticClass:"text-center"},[r("select2",{attrs:{options:t.measurement_units},on:{input:function(r){return t.changeMeasurementUnit(e.index,e.row.measurement_unit_id)}},model:{value:e.row.measurement_unit_id,callback:function(r){t.$set(e.row,"measurement_unit_id",r)},expression:"props.row.measurement_unit_id"}})],1)}},{key:"technical_specifications",fn:function(e){return r("div",{staticClass:"text-center"},[r("span",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.row.technical_specifications,expression:"props.row.technical_specifications"}],staticClass:"form-control",attrs:{type:"text",id:e.index},domProps:{value:e.row.technical_specifications},on:{input:[function(r){r.target.composing||t.$set(e.row,"technical_specifications",r.target.value)},t.changeTecnicalSpecifications]}})])])}},{key:"quantity",fn:function(e){return r("div",{},[r("span",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.row.quantity,expression:"props.row.quantity"}],staticClass:"form-control",attrs:{type:"number",id:e.index,min:"1"},domProps:{value:e.row.quantity},on:{input:[function(r){r.target.composing||t.$set(e.row,"quantity",r.target.value)},t.changeQty]}})])])}},{key:"id",fn:function(e){return r("div",{staticClass:"text-center"},[r("div",{staticClass:"d-inline-flex"},[r("button",{staticClass:"btn btn-danger btn-xs btn-icon btn-action",attrs:{title:"Eliminar registro","data-toggle":"tooltip",type:"button"},on:{click:function(r){return t.removeProduct(e.index,r)}}},[r("i",{staticClass:"fa fa-trash-o"})])])])}}])})],1),t._v(" "),r("div",{staticClass:"card-footer text-right"},[r("buttonsDisplay",{attrs:{route_list:"/purchese/requirements",display:"false"}})],1)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-md-12"},[e("b",[this._v("Información base del requerimiento")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"col-12"},[e("b",[this._v("Ingrese los Productos a la solicitud")])])}],!1,null,null,null);e.default=n.exports},"KHd+":function(t,e,r){"use strict";function i(t,e,r,i,s,n,o,a){var c,d="function"==typeof t?t.options:t;if(e&&(d.render=e,d.staticRenderFns=r,d._compiled=!0),i&&(d.functional=!0),n&&(d._scopeId="data-v-"+n),o?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},d._ssrRegister=c):s&&(c=a?function(){s.call(this,this.$root.$options.shadowRoot)}:s),c)if(d.functional){d._injectStyles=c;var u=d.render;d.render=function(t,e){return c.call(e),u(t,e)}}else{var l=d.beforeCreate;d.beforeCreate=l?[].concat(l,c):[c]}return{exports:t,options:d}}r.d(e,"a",function(){return i})}}]);